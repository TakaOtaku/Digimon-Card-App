<div class="border-2 border-slate-500 text-white">
  <p-contextMenu #table [model]="deckRowContext"></p-contextMenu>
  <p-table
    [(contextMenuSelection)]="selectedDeck"
    [contextMenu]="table"
    [globalFilterFields]="['color.name', 'title', 'tags', '', 'user']"
    [scrollHeight]="'calc(100vh - 48px)'"
    [scrollable]="true"
    [showCurrentPageReport]="true"
    [value]="decks"
    responsiveLayout="scroll"
    styleClass="p-datatable-striped"
  >
    <ng-template pTemplate="header">
      <tr class="p-0">
        <th class="mx-auto max-w-[70px] p-0">
          Color
          <p-columnFilter display="menu" field="color.name" matchMode="equals">
            <ng-template
              let-filter="filterCallback"
              let-value
              pTemplate="filter"
            >
              <p-dropdown
                (onChange)="filter($event.value)"
                [ngModel]="value"
                [options]="colors"
                placeholder="Any"
              >
                <ng-template let-option pTemplate="item">
                  <span [class]="'customer-badge status-' + option">{{
                    option
                  }}</span>
                </ng-template>
              </p-dropdown>
            </ng-template>
          </p-columnFilter>
        </th>
        <th class="max-w-[400px] p-0 text-center">
          Title
          <p-columnFilter
            display="menu"
            field="title"
            type="text"
          ></p-columnFilter>
        </th>
        <th class="max-w-[400px] p-0 text-center">Tags</th>
        <th class="max-w-[400px] p-0 text-center">Description</th>
      </tr>
    </ng-template>
    <ng-template let-deck pTemplate="body">
      <tr [pContextMenuRow]="deck" class="max-h-[50px]">
        <td class="inline-flex max-w-[70px] p-0">
          <img
            [src]="deck.color?.img ?? 'assets/decks/white.svg'"
            alt="Digimon Deck Image"
            class="mx-auto max-h-[50px]"
          />
        </td>
        <td class="max-w-[400px] truncate p-0 lg:max-w-[100%]">
          {{ deck.title }}
        </td>
        <td class="max-w-[400px] p-0 lg:max-w-[100%]">
          <p-chip *ngFor="let tag of deck.tags" label="{{ tag.name }}"></p-chip>
        </td>
        <td class="max-w-[400px] truncate p-0 lg:max-w-[100%]">
          {{ deck.description }}
        </td>
      </tr>
    </ng-template>
  </p-table>

  <p-dialog
    header="Export Deck"
    [showHeader]="false"
    [(visible)]="exportDeckDialog"
    styleClass="w-[100%] min-w-[250px] sm:min-w-[500px] sm:w-[700px] min-h-[500px]"
    [baseZIndex]="10000"
    ><digimon-export-deck-dialog></digimon-export-deck-dialog
  ></p-dialog>

  <p-dialog
    header="Import Deck"
    [showHeader]="false"
    [(visible)]="importDeckDialog"
    styleClass="w-[100%] min-w-[250px] sm:min-w-[500px] sm:w-[700px] min-h-[500px]"
    [baseZIndex]="10000"
    ><digimon-import-deck-dialog></digimon-import-deck-dialog
  ></p-dialog>

  <p-dialog
    [showHeader]="false"
    header="Change Accessory"
    [(visible)]="accessoryDialog"
    styleClass="w-[95vw] xl:w-[50vw] h-[400px]"
    [baseZIndex]="10000"
    ><digimon-change-accessorie-dialog></digimon-change-accessorie-dialog
  ></p-dialog>
</div>
